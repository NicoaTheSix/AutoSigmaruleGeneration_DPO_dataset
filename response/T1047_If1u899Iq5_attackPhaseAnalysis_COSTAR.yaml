1. **Framework Section**  
   Phase 1: *Discovery*  
   - Monitor for WMI queries that gather system information (e.g., `SELECT * FROM Win32_ComputerSystem`)  
   - Analyze logs for remote WMI access attempts, particularly over ports 135, 5985, and 5986  
   - Identify the use of WMI-related tools and scripts (e.g., `wmic.exe`, `PowerShell` commands)  

   Phase 2: *Execution*  
   - Detect execution of commands via WMI (e.g., `wmic process call create`)  
   - Monitor for the use of WMI to launch scripts or binaries remotely  
   - Analyze for patterns of WMI-based lateral movement (e.g., `wmiexec.vbs`, `Impacket`)  

   Phase 3: *Persistence*  
   - Identify WMI event subscriptions that may indicate persistence mechanisms  
   - Monitor for changes to WMI classes or the creation of new WMI objects  
   - Analyze for scheduled tasks or services that leverage WMI for execution  

2. **Behavioral Patterns Section**  
   - **Pattern Name**: WMI Query for System Information  
     - Examples: "Action RAT can use WMI to gather AV products installed on an infected host."  
     - Associated Phase: Discovery  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: Remote Command Execution via WMI  
     - Examples: "Cobalt Strike can use WMI to deliver a payload to a remote host."  
     - Associated Phase: Execution  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Lateral Movement  
     - Examples: "Aquatic Panda used WMI for lateral movement in victim environments."  
     - Associated Phase: Execution  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Deleting Shadow Copies  
     - Examples: "Avaddon uses wmic.exe to delete shadow copies."  
     - Associated Phase: Execution  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI Event Subscription for Persistence  
     - Examples: "APT41 used WMI in several ways, including for execution of commands via WMIEXEC as well as for persistence via PowerSploit."  
     - Associated Phase: Persistence  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Modifying Security Settings  
     - Examples: "During HomeLand Justice, threat actors used WMI to modify Windows Defender settings."  
     - Associated Phase: Execution  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Information Gathering  
     - Examples: "Lazarus Group used WMIC for discovery as well as to execute payloads for persistence and lateral movement."  
     - Associated Phase: Discovery  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Executing PowerShell Commands  
     - Examples: "Ursnif droppers have used WMI classes to execute PowerShell commands."  
     - Associated Phase: Execution  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Network Discovery  
     - Examples: "Wizard Spider has used WMI and LDAP queries for network discovery."  
     - Associated Phase: Discovery  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Credential Theft  
     - Examples: "APT29 used WMI to steal credentials and execute backdoors at a future time."  
     - Associated Phase: Execution  
     - Mapping to TTP ID: T1047  