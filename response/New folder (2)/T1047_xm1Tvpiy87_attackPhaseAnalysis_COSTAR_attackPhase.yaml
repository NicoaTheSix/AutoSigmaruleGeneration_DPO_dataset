1. **Framework Section**  
   Phase 1: *Discovery and Reconnaissance*  
   - Monitor for WMI queries that gather system information (e.g., `SELECT * FROM Win32_ComputerSystem`)  
   - Analyze logs for remote WMI access attempts, particularly over ports 135, 5985, and 5986  
   - Identify the use of WMI-related tools and scripts (e.g., `wmic.exe`, `PowerShell` commands)  

   Phase 2: *Execution*  
   - Detect execution of commands via WMI (e.g., `wmic process call create`)  
   - Monitor for the use of WMI to launch scripts or binaries remotely  
   - Analyze for patterns of WMI-based lateral movement (e.g., `wmiexec.vbs`, `Impacket`)  

   Phase 3: *Persistence and Cleanup*  
   - Identify WMI-based persistence mechanisms (e.g., scheduled tasks created via WMI)  
   - Monitor for deletion of shadow copies or other cleanup activities using WMI  
   - Analyze for modifications to system settings or configurations via WMI  

2. **Behavioral Patterns Section**  
   - **Pattern Name**: WMI Query for System Information  
     - Examples: "Action RAT can use WMI to gather AV products installed on an infected host."  
     - Associated Phase: Discovery and Reconnaissance  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: Remote Command Execution via WMI  
     - Examples: "Cobalt Strike can use WMI to deliver a payload to a remote host."  
     - Associated Phase: Execution  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: Lateral Movement Using WMI  
     - Examples: "Aquatic Panda used WMI for lateral movement in victim environments."  
     - Associated Phase: Execution  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Deleting Shadow Copies  
     - Examples: "Avaddon uses wmic.exe to delete shadow copies."  
     - Associated Phase: Persistence and Cleanup  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI-Based Persistence Mechanisms  
     - Examples: "FIN8's malicious spearphishing payloads use WMI to launch malware."  
     - Associated Phase: Persistence and Cleanup  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Modifying System Settings  
     - Examples: "During HomeLand Justice, threat actors used WMI to modify Windows Defender settings."  
     - Associated Phase: Persistence and Cleanup  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Information Gathering  
     - Examples: "Lazarus Group has used WMIC for discovery as well as to execute payloads."  
     - Associated Phase: Discovery and Reconnaissance  
     - Mapping to TTP ID: T1047  

   - **Pattern Name**: WMI for Executing PowerShell Commands  
     - Examples: "Sardonic can use WMI to execute PowerShell commands on a compromised machine."  
     - Associated Phase: Execution  
     - Mapping to TTP ID: T1047  