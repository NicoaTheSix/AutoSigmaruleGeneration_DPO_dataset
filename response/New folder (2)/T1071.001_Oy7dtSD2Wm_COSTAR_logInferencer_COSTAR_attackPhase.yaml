1. **Identify Initial Access via Spearphishing Email**  
   - Monitor for the creation of processes related to Outlook that involve email interactions. Specifically, look for emails with attachments named "Invoice_2023.xlsx" and subject lines containing "Important Update".  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE" (or similar path for Outlook)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "Invoice_2023.xlsx"  

2. **Identify Opening of Malicious Attachment**  
   - Monitor for the execution of Microsoft Excel processes that open the attachment "Invoice_2023.xlsx".  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE" (or similar path for Excel)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "Invoice_2023.xlsx"  
     - `relation`: "Process Create"  

3. **Detect Macro Execution in Excel**  
   - Monitor for events indicating the execution of macros within Excel files, particularly those that are not digitally signed.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE"  
     - `relation`: "Process Create"  

4. **Identify Payload Execution via PowerShell**  
   - Monitor for PowerShell commands that download files from the internet, especially those that are obfuscated. Look for commands that reference downloading a payload from a remote server.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "malicious.exe" (or similar name for the downloaded payload)  
     - `relation`: "Process Create"  

5. **Detect Establishing Command and Control**  
   - Monitor for outbound connections initiated by newly created processes, particularly those connecting to known malicious IP addresses.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\cmd.exe" (or similar for command execution)  
     - `dstNode.Type`: "Network"  
     - `dstNode.Dstaddress`: "<malicious IP>" (replace with known malicious IP)  
     - `relation`: "TCP Connect"  

6. **Identify Data Exfiltration Attempts**  
   - Monitor for large outbound HTTP/S requests or unusual file types being sent to external servers, indicating potential data exfiltration.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\cmd.exe"  
     - `dstNode.Type`: "Network"  
     - `dstNode.Port`: 80 (or 443 for HTTPS)  
     - `relation`: "TCP Send"  

7. **Detect Persistence Mechanisms**  
   - Monitor for the creation of new scheduled tasks or registry modifications that indicate persistence mechanisms being established by the malware.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\schtasks.exe"  
     - `dstNode.Type`: "Registry"  
     - `dstNode.Key`: "<registry path for persistence>" (replace with actual registry path)  
     - `relation`: "RegCreateKey"  