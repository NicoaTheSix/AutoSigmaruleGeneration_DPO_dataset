```yaml
- title: Identify Initial Access via Spearphishing Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for the creation of processes related to Outlook that involve email interactions, specifically looking for emails with attachments named "Update_Document.docx" and subject lines containing "Important Update".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE"
      dstNode.Type: "File"
      dstNode.Name: "Update_Document.docx"
  condition: selection
  tags:
    - ATT&CK ID: T1566
    - tactic: Initial Access
  level: high
---
- title: Identify Opening the Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Monitor for the execution of Microsoft Word processes that open documents containing macros, specifically looking for the execution of macros with the code `AutoOpen()`.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\WINWORD.EXE"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Initial Access
  level: high
---
- title: Identify Downloading the Payload
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Monitor for PowerShell commands executed as a child process of Word that download files from the internet, specifically looking for commands that include `Invoke-WebRequest` with a URI pointing to a malicious server.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      dstNode.Type: "File"
      dstNode.Name: "payload.exe"
  condition: selection
  tags:
    - ATT&CK ID: T1071
    - tactic: Execution
  level: high
---
- title: Identify Executing the Malicious Payload
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Monitor for the execution of executables from the TEMP directory, particularly those initiated by Office applications, specifically looking for commands that execute `start /B "$env:TEMP\\payload.exe"`.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\cmd.exe"
      dstNode.Type: "Process"
      dstNode.Image: "$env:TEMP\\payload.exe"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high
---
- title: Identify Establishing Persistence
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Monitor for registry modifications that create new services resembling legitimate services, specifically looking for changes to the registry key `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MaliciousService`.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\svchost.exe"
      dstNode.Type: "Registry"
      dstNode.Key: "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MaliciousService"
  condition: selection
  tags:
    - ATT&CK ID: T1543
    - tactic: Persistence
  level: high
---
- title: Identify Command and Control Communication
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor for outbound network connections initiated by the malicious payload to known malicious IP addresses or domains, specifically looking for connections to `http://malicious-server.com`.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\cmd.exe"
      dstNode.Type: "Network"
      dstNode.Dstaddress: "malicious-server.com"
  condition: selection
  tags:
    - ATT&CK ID: T1071
    - tactic: Command and Control
  level: high
---
- title: Identify Data Exfiltration
  id: 123e4567-e89b-12d3-a456-426614174006
  description: Monitor for PowerShell commands that exfiltrate data to external servers, particularly those involving sensitive file paths, specifically looking for commands that include `Invoke-WebRequest` with a POST method to `http://malicious-server.com/exfiltrate`.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      dstNode.Type: "Network"
      dstNode.Dstaddress: "malicious-server.com"
  condition: selection
  tags:
    - ATT&CK ID: T1041
    - tactic: Exfiltration
  level: high
```