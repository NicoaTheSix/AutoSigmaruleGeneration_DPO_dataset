1. **Framework Section**  
   Phase 1: *User Identification*  
   - Analyze system logs for user account access patterns.  
   - Monitor command execution for user enumeration commands (e.g., `whoami`, `quser`, `dscl`).  
   - Collect and review environment variables related to user sessions (e.g., `%USERNAME%`, `$USER`).  

   Phase 2: *Session Discovery*  
   - Track active user sessions and their privileges using commands like `query user` and `show users`.  
   - Investigate process ownership to identify which users are running specific processes.  
   - Examine network device logs for user login activity (e.g., `show ssh`).  

   Phase 3: *Credential Dumping*  
   - Monitor for tools and commands associated with credential dumping (e.g., `GetUserNameA`, `WMIEXEC`).  
   - Analyze file artifacts for saved usernames and credentials.  
   - Review for suspicious scripts or executables that may be used to extract user information.  

2. **Behavioral Patterns Section**  
   - **Pattern Name**: User Enumeration via Command Execution  
     - Examples: "APT32 collected the victim's username and executed the whoami command on the victim's machine."  
     - Associated Phase: Phase 1  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: Active Session Discovery  
     - Examples: "APT41 has executed whoami commands, including using the WMIEXEC utility to execute this on remote machines."  
     - Associated Phase: Phase 2  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: Credential Extraction  
     - Examples: "Agent.btz obtains the victim username and saves it to a file."  
     - Associated Phase: Phase 3  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: Environment Variable Access  
     - Examples: "Various Lazarus Group malware enumerates logged-on users."  
     - Associated Phase: Phase 1  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: User Privilege Verification  
     - Examples: "An APT3 downloader uses the Windows command 'cmd.exe' /C whoami to verify that it is running with the elevated privileges of 'System.'"  
     - Associated Phase: Phase 2  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: User Information Transmission  
     - Examples: "Felismus collects the current username and sends it to the C2 server."  
     - Associated Phase: Phase 3  
     - Mapping to TTP ID: T1033  