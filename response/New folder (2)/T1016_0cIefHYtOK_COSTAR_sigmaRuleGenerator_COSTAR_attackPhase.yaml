```yaml
- title: Identify Initial Access via Spearphishing Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for the creation of processes related to Outlook that involve email interactions, specifically for emails with attachments named "Invoice.xlsx" and subject lines containing "Important Document".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE"
      dstNode.Type: "File"
      dstNode.Name: "Invoice.xlsx"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1566
    - tactic: Initial Access
  level: high
---
- title: Identify Execution of Malicious Payload
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Monitor for the execution of Microsoft Excel processes that open the "Invoice.xlsx" file, looking for PowerShell commands executed from within Excel that attempt to download a file from a suspicious URL.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE"
      dstNode.Type: "File"
      dstNode.Name: "Invoice.xlsx"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high
---
- title: Identify Payload Execution
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Monitor for the execution of the downloaded payload (e.g., "payload.exe") from the temporary directory, looking for process creation events that indicate the execution of this file.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\cmd.exe"
      dstNode.Type: "Process"
      dstNode.Image: "$env:TEMP\\payload.exe"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1059
    - tactic: Execution
  level: high
---
- title: Identify Command and Control Communication
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Monitor for network connections initiated by the RAT to known malicious command and control (C2) servers, looking for HTTP/HTTPS traffic that includes suspicious URLs.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "$env:TEMP\\payload.exe"
      dstNode.Type: "Network"
      dstNode.Dstaddress: "malicious.com"
      relation: "TCP Connect"
  condition: selection
  tags:
    - ATT&CK ID: T1071
    - tactic: Command and Control
  level: high
---
- title: Identify Data Exfiltration
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Monitor for processes that collect and send sensitive data to external servers, looking for commands that zip files and use HTTP POST requests to upload data.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "$env:TEMP\\payload.exe"
      dstNode.Type: "Network"
      dstNode.Dstaddress: "malicious.com"
      relation: "TCP Send"
  condition: selection
  tags:
    - ATT&CK ID: T1041
    - tactic: Exfiltration
  level: high
---
- title: Identify Cleanup and Persistence Mechanisms
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor for the creation of scheduled tasks that may indicate persistence mechanisms employed by the RAT, looking for commands that create tasks to run the payload on startup.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\schtasks.exe"
      dstNode.Type: "Registry"
      dstNode.Key: "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1053
    - tactic: Persistence
  level: high
```