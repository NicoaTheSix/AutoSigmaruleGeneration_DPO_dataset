1. **Identify Initial Access via Spearphishing Email**  
   - Monitor for the creation of processes related to Outlook (or any email client) that involve the opening of emails with attachments named "invoice.docx".  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE" (or similar path for Outlook)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "invoice.docx"  
     - `relation`: "Process Create"  

2. **Identify Execution of Malicious Payload**  
   - Monitor for the execution of Microsoft Word (or any office suite) processes that open the malicious document containing macros.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\WINWORD.EXE" (or similar path for Word)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "invoice.docx"  
     - `relation`: "Process Create"  

3. **Identify Payload Execution**  
   - Monitor for the creation of the `payload.exe` process in the user's Downloads folder, indicating the execution of the downloaded payload.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Users\\Target\\Downloads\\payload.exe"  
     - `relation`: "Process Create"  

4. **Identify Network Connection to C2 Server**  
   - Monitor for network connections initiated by `payload.exe` to the attacker's command and control (C2) server.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Users\\Target\\Downloads\\payload.exe"  
     - `dstNode.Type`: "Network"  
     - `dstNode.Dstaddress`: "<C2 server IP>" (replace with actual C2 server IP)  
     - `relation`: "TCP Connect"  

5. **Identify Data Discovery and Collection**  
   - Monitor for PowerShell commands executed to enumerate files of interest, particularly those targeting the Documents folder.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "*.docx" or "*.xlsx"  
     - `relation`: "Process Create"  

6. **Identify Data Exfiltration**  
   - Monitor for PowerShell commands that upload files to the C2 server, particularly HTTP POST requests.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"  
     - `dstNode.Type`: "Network"  
     - `dstNode.Dstaddress`: "<C2 server IP>" (replace with actual C2 server IP)  
     - `relation`: "TCP Send"  

7. **Identify Cleanup and Obfuscation**  
   - Monitor for PowerShell commands that delete the downloaded payload and any logs, indicating an attempt to cover tracks.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "C:\\Users\\Target\\Downloads\\payload.exe"  
     - `relation`: "DeleteFile" (or similar relation for deletion actions)  