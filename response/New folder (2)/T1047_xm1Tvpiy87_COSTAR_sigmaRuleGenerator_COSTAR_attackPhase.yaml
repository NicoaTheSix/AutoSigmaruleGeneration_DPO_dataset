```yaml
- title: Identify Initial Access via Spearphishing Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for the creation of processes related to Outlook that involve email interactions, specifically for emails with attachments named "Invoice_2023.xlsx" and subject lines containing "Invoice Attached".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE"
      dstNode.Type: "File"
      dstNode.Name: "Invoice_2023.xlsx"
  condition: selection
  tags:
    - ATT&CK ID: T1566
    - tactic: Initial Access
  level: high
---
- title: Identify Opening of Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Monitor for the execution of Excel processes that open the attachment "Invoice_2023.xlsx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE"
      dstNode.Type: "File"
      dstNode.Name: "Invoice_2023.xlsx"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Initial Access
  level: high
---
- title: Identify Execution of PowerShell Script
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Monitor for PowerShell execution commands that include `-ExecutionPolicy Bypass` and are invoked by Excel macros.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      srcNode.Cmdline: "-ExecutionPolicy Bypass -File C:\\Users\\Public\\malicious_script.ps1"
      dstNode.Type: "File"
      dstNode.Name: "malicious_script.ps1"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1059
    - tactic: Execution
  level: high
---
- title: Identify Payload Execution
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Monitor for the execution of the downloaded payload executable that establishes a reverse shell connection.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Users\\Public\\payload.exe"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high
---
- title: Identify Establishing Persistence via WMI
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Monitor for the creation of scheduled tasks using WMI that reference the payload executable.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "wmic.exe"
      dstNode.Type: "Process"
      dstNode.Image: "C:\\Users\\Public\\payload.exe"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1543
    - tactic: Persistence
  level: high
---
- title: Identify Cleanup and Covering Tracks
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor for PowerShell commands that delete event logs or shadow copies, indicating an attempt to cover tracks.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      srcNode.Cmdline: "-Command \"wevtutil cl Security\""
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1070
    - tactic: Defense Evasion
  level: high
```