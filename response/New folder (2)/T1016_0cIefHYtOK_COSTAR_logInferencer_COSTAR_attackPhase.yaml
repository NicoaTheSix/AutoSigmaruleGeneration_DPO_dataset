1. **Identify Initial Access via Spearphishing Email**  
   - Monitor for the creation of processes related to Outlook that involve email interactions. Specifically, look for emails with attachments named "Invoice.xlsx" and subject lines containing "Important Document".  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE" (or similar path for Outlook)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "Invoice.xlsx"  
     - `relation`: "Process Create"  

2. **Identify Execution of Malicious Payload**  
   - Monitor for the execution of Microsoft Excel processes that open the "Invoice.xlsx" file. Look for PowerShell commands executed from within Excel that attempt to download a file from a suspicious URL.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE" (or similar path for Excel)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "Invoice.xlsx"  
     - `relation`: "Process Create"  

3. **Identify Payload Execution**  
   - Monitor for the execution of the downloaded payload (e.g., "payload.exe") from the temporary directory. Look for process creation events that indicate the execution of this file.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\cmd.exe" (or similar path for Command Prompt)  
     - `dstNode.Type`: "Process"  
     - `dstNode.Image`: "$env:TEMP\\payload.exe"  
     - `relation`: "Process Create"  

4. **Identify Command and Control Communication**  
   - Monitor for network connections initiated by the RAT to known malicious command and control (C2) servers. Look for HTTP/HTTPS traffic that includes suspicious URLs.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "$env:TEMP\\payload.exe"  
     - `dstNode.Type`: "Network"  
     - `dstNode.Dstaddress`: "malicious.com" (or similar C2 domain)  
     - `relation`: "TCP Connect"  

5. **Identify Data Exfiltration**  
   - Monitor for processes that collect and send sensitive data to external servers. Look for commands that zip files and use HTTP POST requests to upload data.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "$env:TEMP\\payload.exe"  
     - `dstNode.Type`: "Network"  
     - `dstNode.Dstaddress`: "malicious.com" (or similar C2 domain)  
     - `relation`: "TCP Send"  

6. **Identify Cleanup and Persistence Mechanisms**  
   - Monitor for the creation of scheduled tasks that may indicate persistence mechanisms employed by the RAT. Look for commands that create tasks to run the payload on startup.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\schtasks.exe"  
     - `dstNode.Type`: "Registry"  
     - `dstNode.Key`: "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" (or similar registry path)  
     - `relation`: "Process Create"  