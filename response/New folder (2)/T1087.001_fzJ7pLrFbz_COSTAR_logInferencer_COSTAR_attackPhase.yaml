1. **Identify Initial Access via Email**  
   - Monitor for the creation of processes related to Microsoft Outlook when an email with the subject line "Important Document" is received and contains an attachment named "Invoice.xlsx".  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE" (or similar path for Outlook)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "Invoice.xlsx"  
     - `relation`: "Process Create"  

2. **Identify Exploitation of Vulnerability**  
   - Monitor for the execution of Microsoft Excel when the "Invoice.xlsx" file is opened, particularly looking for the execution of macros.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE" (or similar path for Excel)  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "Invoice.xlsx"  
     - `relation`: "Process Create"  

3. **Detect Payload Delivery via PowerShell**  
   - Monitor for PowerShell commands executed by Excel macros that download a malicious executable from a remote server.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"  
     - `dstNode.Type`: "File"  
     - `dstNode.Name`: "payload.exe"  
     - `relation`: "Process Create"  
     - `srcNode.Cmdline`: `*Invoke-WebRequest*`  

4. **Detect Execution of Malicious Payload**  
   - Monitor for the execution of the downloaded payload executable from the temporary directory.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"  
     - `dstNode.Type`: "Process"  
     - `dstNode.Image`: "$env:temp\\payload.exe"  
     - `relation`: "Process Create"  

5. **Identify Persistence Mechanism**  
   - Monitor for registry modifications that add entries to ensure the malicious payload runs on system startup.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\reg.exe"  
     - `dstNode.Type`: "Registry"  
     - `dstNode.Key`: "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"  
     - `relation`: "RegSetValue"  

6. **Detect Command and Control Communication**  
   - Monitor for PowerShell commands that initiate network communication with a command and control server.  
   - Schema Fields:  
     - `srcNode.Type`: "Process"  
     - `srcNode.Image`: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"  
     - `dstNode.Type`: "Network"  
     - `dstNode.Dstaddress`: "malicious.com"  
     - `relation`: "TCP Connect"  
     - `srcNode.Cmdline`: `*Invoke-WebRequest*`  