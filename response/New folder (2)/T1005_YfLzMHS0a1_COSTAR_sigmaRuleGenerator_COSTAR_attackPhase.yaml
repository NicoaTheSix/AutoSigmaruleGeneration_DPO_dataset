```yaml
- title: Identify Initial Access via Spearphishing Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for the creation of processes related to Outlook that involve the opening of emails with attachments named "invoice.docx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE"
      dstNode.Type: "File"
      dstNode.Name: "invoice.docx"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1566
    - tactic: Initial Access
  level: high
---
- title: Identify Execution of Malicious Payload
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Monitor for the execution of Microsoft Word processes that open the malicious document containing macros.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\WINWORD.EXE"
      dstNode.Type: "File"
      dstNode.Name: "invoice.docx"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high
---
- title: Identify Payload Execution
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Monitor for the creation of the payload.exe process in the user's Downloads folder, indicating the execution of the downloaded payload.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Users\\Target\\Downloads\\payload.exe"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high
---
- title: Identify Network Connection to C2 Server
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Monitor for network connections initiated by payload.exe to the attacker's command and control (C2) server.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Users\\Target\\Downloads\\payload.exe"
      dstNode.Type: "Network"
      dstNode.Dstaddress: "<C2 server IP>"
      relation: "TCP Connect"
  condition: selection
  tags:
    - ATT&CK ID: T1071
    - tactic: Command and Control
  level: high
---
- title: Identify Data Discovery and Collection
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Monitor for PowerShell commands executed to enumerate files of interest, particularly those targeting the Documents folder.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      dstNode.Type: "File"
      dstNode.Name: "*.docx"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1210
    - tactic: Collection
  level: medium
---
- title: Identify Data Exfiltration
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor for PowerShell commands that upload files to the C2 server, particularly HTTP POST requests.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      dstNode.Type: "Network"
      dstNode.Dstaddress: "<C2 server IP>"
      relation: "TCP Send"
  condition: selection
  tags:
    - ATT&CK ID: T1041
    - tactic: Exfiltration
  level: high
---
- title: Identify Cleanup and Obfuscation
  id: 123e4567-e89b-12d3-a456-426614174006
  description: Monitor for PowerShell commands that delete the downloaded payload and any logs, indicating an attempt to cover tracks.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      dstNode.Type: "File"
      dstNode.Name: "C:\\Users\\Target\\Downloads\\payload.exe"
      relation: "DeleteFile"
  condition: selection
  tags:
    - ATT&CK ID: T1070
    - tactic: Defense Evasion
  level: medium
```