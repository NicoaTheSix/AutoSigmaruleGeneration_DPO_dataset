```yaml
- title: Identify Initial Access via Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for the creation of processes related to Outlook when an email with the subject line "Urgent: Invoice Attached" is received.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE"
      dstNode.Type: "File"
      dstNode.Name: "Invoice_2023.xlsx"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Initial Access
  level: high
---
- title: Monitor Opening of Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Track the spawning of the Excel process when the attachment Invoice_2023.xlsx is opened.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE"
      dstNode.Type: "File"
      dstNode.Name: "Invoice_2023.xlsx"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Initial Access
  level: high
---
- title: Detect Macro Execution
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Look for the execution of commands within the Excel process that indicate a macro is running, specifically commands that download a payload.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE"
      dstNode.Type: "Process"
      dstNode.Image: "C:\\Windows\\System32\\cmd.exe"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high
---
- title: Track Payload Download and Execution
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Monitor for the execution of commands that download and run the payload from a remote server using cmd.exe.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\cmd.exe"
      dstNode.Type: "Process"
      dstNode.Image: "%temp%\\payload.exe"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high
---
- title: Identify Registry Modifications for Persistence
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Detect registry modifications that add entries for persistence under HKCU\Software\Microsoft\Windows\CurrentVersion\Run.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\reg.exe"
      dstNode.Type: "Registry"
      dstNode.Key: "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
  condition: selection
  tags:
    - ATT&CK ID: T1547
    - tactic: Persistence
  level: medium
---
- title: Monitor Network Communication for Data Exfiltration
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Track outbound network connections to suspicious IP addresses that may indicate data exfiltration.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\cmd.exe"
      dstNode.Type: "Network"
      dstNode.Dstaddress: "192.0.2.1"
  condition: selection
  tags:
    - ATT&CK ID: T1041
    - tactic: Exfiltration
  level: high
---
- title: Detect Follow-on Actions
  id: 123e4567-e89b-12d3-a456-426614174006
  description: Monitor for additional commands executed on the system that indicate further reconnaissance or lateral movement.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Type: "Process"
      srcNode.Image: "C:\\Windows\\System32\\cmd.exe"
      dstNode.Type: "Process"
      dstNode.Image: "C:\\Windows\\System32\\systeminfo.exe"
  condition: selection
  tags:
    - ATT&CK ID: T1087
    - tactic: Discovery
  level: medium
```