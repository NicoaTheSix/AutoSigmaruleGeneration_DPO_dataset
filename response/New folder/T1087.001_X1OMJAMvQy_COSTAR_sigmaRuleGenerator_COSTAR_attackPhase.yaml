```yaml
- title: Identify Initial Access via Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for events where the srcNode is an email client and the dstNode is a file indicating potential malicious attachments.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode: "email_client"
      dstNode: "malicious_document.docx"
      sender: "unknown"
      attachment: "executable_macro"
  condition: selection
  tags:
    - T1203
    - Initial Access
  level: high

---
- title: Map Opening the Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Look for Process Create events where the srcNode is Microsoft Word and the dstNode indicates macro execution.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode: "Microsoft Word"
      dstNode: "malicious_document.docx"
      cmdline: "*macro_execution*"
  condition: selection
  tags:
    - T1203
    - Execution
  level: medium

---
- title: Validate Execution of the Downloaded Payload
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Detect Process Create events where the srcNode is cmd.exe or explorer.exe executing the payload.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode: 
        - "cmd.exe"
        - "explorer.exe"
      dstNode: "payload.exe"
      relation: "direct_execution"
  condition: selection
  tags:
    - T1203
    - Execution
  level: high

---
- title: Monitor for Establishing Persistence
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Track registry modification events for persistence related to payload.exe.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode: "process_modifying_registry"
      dstNode: "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\payload.exe"
      action: 
        - "RegSetValue"
        - "RegCreateKey"
  condition: selection
  tags:
    - T1547
    - Persistence
  level: medium

---
- title: Detect Data Exfiltration
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Identify TCP Connect events where the srcNode is a web browser connecting to a known malicious IP.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode: "web_browser"
      dstNode: "malicious_ip_or_domain"
      relation: "outbound_traffic"
  condition: selection
  tags:
    - T1041
    - Exfiltration
  level: high

---
- title: Capture Cleanup and Evasion
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor for Process Create events executing deletion commands for payload.exe.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode: "cmd.exe"
      action: "deletion_command"
      target: "payload.exe"
      location: "temp_directory"
  condition: selection
  tags:
    - T1070
    - Defense Evasion
  level: medium
```