```yaml
- title: Identify Initial Access via Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for events where Microsoft Outlook is used to receive emails from suspicious domains, specifically looking for attachments named "Invoice_2023.xlsx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventID: 25
      Sender: "*@example.com"
      AttachmentName: "Invoice_2023.xlsx"
  condition: selection
  tags:
    - T1566
    - Initial Access
  level: high
---
- title: Map Opening of Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Detect when Microsoft Excel is launched with the command line containing the path to "Invoice_2023.xlsx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      ProcessName: "excel.exe"
      CommandLine: "*Invoice_2023.xlsx*"
  condition: selection
  tags:
    - T1203
    - Execution
  level: high
---
- title: Validate Macro Execution
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Look for events where Microsoft Excel executes macros, specifically tracking instances where PowerShell is invoked from within Excel.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      ProcessName: "powershell.exe"
      CommandLine: "*-ExecutionPolicy Bypass -Command \"Invoke-WebRequest*"
  condition: selection
  tags:
    - T1059
    - Execution
  level: high
---
- title: Capture Payload Execution
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Monitor for the execution of the downloaded executable "payload.exe".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      ProcessName: "payload.exe"
      CommandLine: "*C:\\Users\\User\\AppData\\Local\\Temp\\payload.exe*"
  condition: selection
  tags:
    - T1203
    - Execution
  level: high
---
- title: Detect Registry Modification for Persistence
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Identify events where registry modifications occur, specifically looking for entries created under HKCU\Software\Microsoft\Windows\CurrentVersion\Run.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      RegistryKey: "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
      CommandLine: "*reg add*"
  condition: selection
  tags:
    - T1547
    - Persistence
  level: medium
---
- title: Monitor Data Exfiltration Attempts
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Track PowerShell commands that attempt to exfiltrate data, particularly those that use Invoke-WebRequest to send data to an external server.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      ProcessName: "powershell.exe"
      CommandLine: "*Invoke-WebRequest -Uri 'http://malicious.com/exfiltrate'*"
  condition: selection
  tags:
    - T1041
    - Exfiltration
  level: high
---
- title: Identify Cleanup and Evasion Activities
  id: 123e4567-e89b-12d3-a456-426614174006
  description: Detect instances where PowerShell is used to delete temporary files, specifically looking for commands that remove "payload.exe".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      ProcessName: "powershell.exe"
      CommandLine: "*Remove-Item 'C:\\Users\\User\\AppData\\Local\\Temp\\payload.exe'*"
  condition: selection
  tags:
    - T1070
    - Defense Evasion
  level: medium
```