1. **Framework Section**  
   Phase 1: *Network Discovery*  
   - Analyze network connection commands (e.g., `netstat`, `net use`, `net session`) for active connections.  
   - Monitor for the use of network enumeration tools and scripts that gather connection details.  
   - Identify and log queries made to network devices for connection information (e.g., `show ip sockets`, `show tcp brief`).  

   Phase 2: *Cloud Environment Mapping*  
   - Investigate commands and tools used to map Virtual Private Clouds (VPCs) and Virtual Networks (VNs).  
   - Track access to cloud provider APIs or interfaces that reveal network configurations and connected services.  
   - Monitor for enumeration of cloud resources and services that may indicate reconnaissance activities.  

   Phase 3: *Session Enumeration*  
   - Detect commands that enumerate user sessions (e.g., `who -a`, `quser.exe`, `WNetOpenEnumW`).  
   - Analyze logs for RDP session queries and other remote access methods that reveal active user connections.  
   - Identify tools that capture session details from compromised hosts (e.g., `Cobalt Strike`, `Empire`).  

2. **Behavioral Patterns Section**  
   - **Pattern Name**: Network Connection Enumeration  
     - Examples: `netstat -ano >> %temp%\download`, `netstat -naop tcp`, `net use`  
     - Associated Phase: Network Discovery  
     - Mapping to TTP ID: T1049  

   - **Pattern Name**: Cloud Resource Mapping  
     - Examples: Accessing cloud provider APIs to identify VPCs, using commands to check for DirectConnect or VPN configurations.  
     - Associated Phase: Cloud Environment Mapping  
     - Mapping to TTP ID: T1049  

   - **Pattern Name**: User Session Discovery  
     - Examples: `quser.exe`, `who -a`, `WNetOpenEnumW`  
     - Associated Phase: Session Enumeration  
     - Mapping to TTP ID: T1049  

   - **Pattern Name**: Active Connection Monitoring  
     - Examples: Using `MAPMAKER` to print active TCP connections, `netstat -an` to discover open ports.  
     - Associated Phase: Network Discovery  
     - Mapping to TTP ID: T1049  

   - **Pattern Name**: RDP Session Enumeration  
     - Examples: `Earth Lusca` using PowerShell to read RDP connection logs, `quser.exe` to identify existing RDP connections.  
     - Associated Phase: Session Enumeration  
     - Mapping to TTP ID: T1049  

   - **Pattern Name**: Network Device Querying  
     - Examples: Using `show ip sockets`, `show tcp brief` on network devices.  
     - Associated Phase: Network Discovery  
     - Mapping to TTP ID: T1049  