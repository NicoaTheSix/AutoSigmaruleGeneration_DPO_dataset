```yaml
- title: Identify Initial Access via Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Detects initial access attempts via email with suspicious subject lines and attachments.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      subject: "Important Document"
      attachment: "Invoice.xlsx"
      sender: 
        - "*@suspiciousdomain.com"
  condition: selection
  tags:
    - T1203
    - Initial Access
  level: high

---
- title: Monitor Opening of Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Detects execution of Microsoft Excel with a specific command line indicating the opening of a malicious attachment.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\OfficeXX\\EXCEL.EXE"
      dstNode.Image: "C:\\Users\\Victim\\Downloads\\Invoice.xlsx"
  condition: selection
  tags:
    - T1203
    - Initial Access
  level: high

---
- title: Capture Macro Execution and Payload Download
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Detects PowerShell execution initiated by Excel macros for downloading payloads.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\OfficeXX\\EXCEL.EXE"
      dstNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      Cmdline:
        - "*Invoke-WebRequest*"
        - "*curl*"
  condition: selection
  tags:
    - T1203
    - Initial Access
  level: high

---
- title: Log Execution of the Malicious Payload
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Detects execution of a malicious executable downloaded from a malicious attachment.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Windows\\explorer.exe"
      dstNode.Image: "C:\\Users\\Victim\\Downloads\\malicious.exe"
  condition: selection
  tags:
    - T1203
    - Execution
  level: high

---
- title: Track Command and Control Communication
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Monitors outbound network connections initiated by a malicious executable.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Users\\Victim\\Downloads\\malicious.exe"
      dstNode.Type: "Network"
      relation: "TCP Connect"
      dstNode.Dstaddress: 
        - "malicious_ip_or_domain"
  condition: selection
  tags:
    - T1071
    - Command and Control
  level: high

---
- title: Detect Data Exfiltration or Further Exploitation
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Identifies unusual outbound data transfers or access to sensitive files indicating potential data exfiltration.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      relation: "TCP Send"
      data_transfer: 
        - "large_data_transfer_pattern"
  condition: selection
  tags:
    - T1041
    - Exfiltration
  level: high
```