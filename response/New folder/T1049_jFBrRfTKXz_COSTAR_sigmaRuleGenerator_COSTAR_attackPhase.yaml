```yaml
- title: Identify Initial Access via Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for email logs that contain the subject line "Important Update" and an attachment named "Invoice_2023.xlsx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      subject: "Important Update"
      attachment: "Invoice_2023.xlsx"
  condition: selection
  tags:
    - T1566
    - Initial Access
  level: high

---
- title: Map Opening of Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Detect when the user opens the Excel attachment, specifically looking for logs indicating the execution of macros within the Excel file.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      event_type: "macro_execution"
      file_extension: ".xlsx"
  condition: selection
  tags:
    - T1203
    - Execution
  level: high

---
- title: Validate Macro Execution and Payload Download
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Monitor for PowerShell command logs that include the execution of Invoke-WebRequest to download a file from a remote server.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      command: "Invoke-WebRequest"
  condition: selection
  tags:
    - T1105
    - Execution
  level: high

---
- title: Detect Execution of the Malicious Payload
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Identify outbound network connections initiated by the newly created executable that establish a reverse shell connection to a command and control (C2) server.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      connection_type: "outbound"
      connection_direction: "reverse_shell"
  condition: selection
  tags:
    - T1043
    - Command and Control
  level: high

---
- title: Monitor for Establishing Persistence
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Track the creation of scheduled tasks that execute unusual executables, indicating persistence mechanisms being established.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      task_type: "scheduled_task"
      executable: "unusual_executable"
  condition: selection
  tags:
    - T1053
    - Persistence
  level: medium

---
- title: Identify Data Exfiltration Activities
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor network traffic logs for large outbound data transfers, particularly to known malicious IP addresses, indicating potential data exfiltration.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      direction: "outbound"
      data_size: ">100MB"
      destination_ip: "malicious_ip"
  condition: selection
  tags:
    - T1041
    - Exfiltration
  level: high
```