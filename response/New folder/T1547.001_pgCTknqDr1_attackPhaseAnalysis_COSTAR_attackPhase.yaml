1. **Framework Section**  
   Phase 1: *Initial Execution*  
   - Monitor for modifications to the following Registry keys:  
     - `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`  
     - `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run`  
   - Detect the creation of executable files in the Startup folder:  
     - `%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup`  
     - `%ProgramData%\Microsoft\Windows\Start Menu\Programs\Startup`  
   - Analyze command-line arguments for processes that may indicate the execution of malicious payloads during user login.  

   Phase 2: *Persistence Mechanism*  
   - Identify and log changes to Registry keys associated with startup programs, including:  
     - `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce`  
     - `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce`  
   - Monitor for the presence of shortcuts (`.lnk` files) in the Startup folders that may point to malicious executables.  
   - Track the use of the `RunServices` Registry keys to detect attempts to establish persistence through service execution.  

   Phase 3: *Post-Execution Analysis*  
   - Conduct forensic analysis of the Registry to identify any unauthorized entries or modifications.  
   - Review system logs for events related to the execution of programs from the Startup folder or Registry run keys.  
   - Correlate detected persistence mechanisms with known malware signatures or behaviors to identify potential threats.  

2. **Behavioral Patterns Section**  
   - **Pattern Name**: Registry Run Key Modification  
     - Examples:  
       - "ADVSTORESHELL achieves persistence by adding itself to the HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run Registry key."  
       - "Agent Tesla can add itself to the Registry as a startup program to establish persistence."  
     - Associated Phase: Phase 1  
     - Mapping to TTP ID: T1547.001  

   - **Pattern Name**: Startup Folder Manipulation  
     - Examples:  
       - "Amadey has changed the Startup folder to the one containing its executable by overwriting the registry keys."  
       - "APT28 has deployed malware that has copied itself to the startup directory for persistence."  
     - Associated Phase: Phase 2  
     - Mapping to TTP ID: T1547.001  

   - **Pattern Name**: Use of RunOnce Keys  
     - Examples:  
       - "AppleSeed has the ability to create the Registry key name EstsoftAutoUpdate at HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce to establish persistence."  
       - "AvosLocker has been executed via the RunOnce Registry key to run itself on safe mode."  
     - Associated Phase: Phase 2  
     - Mapping to TTP ID: T1547.001  

   - **Pattern Name**: Shortcut Creation in Startup Folder  
     - Examples:  
       - "DarkGate installation finishes with the creation of a registry Run key."  
       - "ObliqueRAT can gain persistence by creating a shortcut in the infected user's Startup directory."  
     - Associated Phase: Phase 2  
     - Mapping to TTP ID: T1547.001  

   - **Pattern Name**: Service Execution via Registry  
     - Examples:  
       - "APT32 established persistence using Registry Run keys, both to execute PowerShell and VBS scripts as well as to execute their backdoor directly."  
       - "Cobalt Group has used Registry Run keys for persistence."  
     - Associated Phase: Phase 3  
     - Mapping to TTP ID: T1547.001  