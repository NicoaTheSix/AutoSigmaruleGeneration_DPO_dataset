```yaml
- title: Monitor for Suspicious Email Attachments
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Identify events where an email is received with the subject "Invoice Attached" and an attachment named "Invoice_2023.xlsx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      subject: "Invoice Attached"
      attachment: "Invoice_2023.xlsx"
  condition: selection
  tags:
    - T1203
    - Initial Access
  level: high
---
- title: Detect Execution of Macros in Excel
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Map events where the Excel file "Invoice_2023.xlsx" is opened, specifically looking for the execution of macros that invoke PowerShell commands.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      process_name: "excel.exe"
      file_name: "Invoice_2023.xlsx"
      command_line: "*powershell*"
  condition: selection
  tags:
    - T1059
    - Execution
  level: high
---
- title: Track PowerShell Script Execution
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Validate events where PowerShell is executed with commands that include "Invoke-WebRequest" to download an executable from "http://malicious-website.com/payload.exe".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      process_name: "powershell.exe"
      command_line: "*Invoke-WebRequest*http://malicious-website.com/payload.exe*"
  condition: selection
  tags:
    - T1059
    - Execution
  level: high
---
- title: Monitor for Executable Execution in Temp Directory
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Identify events where the executable "payload.exe" is created and executed from the Temp directory.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      process_name: "payload.exe"
      file_path: "*\\Temp\\*"
  condition: selection
  tags:
    - T1203
    - Execution
  level: high
---
- title: Detect Registry Modifications for Persistence
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Monitor for events indicating modifications to the Registry key "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\MaliciousPayload".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      registry_key: "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\MaliciousPayload"
      action: "RegSetValue"
  condition: selection
  tags:
    - T1547
    - Persistence
  level: high
---
- title: Track Data Exfiltration via PowerShell
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Identify events where PowerShell is used to send data to external servers, specifically looking for commands that include "Invoke-WebRequest" with a POST method to "http://malicious-website.com/exfiltrate".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      process_name: "powershell.exe"
      command_line: "*Invoke-WebRequest*POST*http://malicious-website.com/exfiltrate*"
  condition: selection
  tags:
    - T1041
    - Exfiltration
  level: high
```