```yaml
- title: Identify Initial Access via Spearphishing Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for incoming emails where the subject line contains "Invoice Attached" and includes an attachment named "Invoice_12345.docx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      subject: "*Invoice Attached*"
      attachment: "Invoice_12345.docx"
  condition: selection
  tags:
    - T1566
    - Initial Access
  level: high
---
- title: Detect Document Execution with Malicious Macro
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Monitor for the execution of Microsoft Word documents that contain macros, specifically those invoking PowerShell commands.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      document_name: "Invoice_12345.docx"
      macro_code: "Sub AutoOpen() Shell(\"powershell.exe -ExecutionPolicy Bypass -NoProfile -File C:\\\\Users\\\\User\\\\Downloads\\\\malicious.ps1\") End Sub"
  condition: selection
  tags:
    - T1203
    - Execution
  level: high
---
- title: Track PowerShell Command for Payload Download
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Monitor for PowerShell commands that utilize Invoke-WebRequest to download files from suspicious URLs.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      command: "Invoke-WebRequest"
      uri: "http://malicious-server.com/malicious.ps1"
      outfile: "C:\\Users\\User\\Downloads\\malicious.ps1"
  condition: selection
  tags:
    - T1105
    - Execution
  level: medium
---
- title: Monitor Execution of Malicious Payload
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Track the execution of scripts from the Downloads folder, particularly those newly created.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      executed_script_path: "C:\\Users\\User\\Downloads\\malicious.ps1"
  condition: selection
  tags:
    - T1059
    - Execution
  level: high
---
- title: Detect Registry Modifications for Persistence
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Monitor for modifications to the Registry keys associated with startup programs, specifically targeting changes to HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\MaliciousApp.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      registry_key: "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\MaliciousApp"
  condition: selection
  tags:
    - T1547
    - Persistence
  level: medium
```