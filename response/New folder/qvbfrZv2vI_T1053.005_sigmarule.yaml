```yaml
- title: Identify Initial Access via Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for incoming emails that contain attachments with the filename pattern *.xlsx from suspicious domains.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      dstNode.Name: "malicious-domain.com"
      dstNode.Type: "File"
      dstNode.Key: "*.xlsx"
  condition: selection
  tags:
    - ATT&CK ID: T1566
    - tactic: Initial Access
  level: high

---
- title: Map User Interaction with Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Detect when Microsoft Excel is opened with a command line that includes a malicious attachment.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\OfficeXX\\EXCEL.EXE"
      dstNode.Image: "*\\Invoice_2023.xlsx"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high

---
- title: Validate Execution of Malicious Macro
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Monitor for the execution of macros within Excel that may download a payload.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\OfficeXX\\EXCEL.EXE"
      dstNode.Image: "C:\\Users\\<username>\\AppData\\Local\\Temp\\payload.exe"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high

---
- title: Detect Payload Execution
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Track the execution of the downloaded payload, specifically looking for command line executions that include the payload path.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Windows\\System32\\cmd.exe"
      dstNode.Image: "C:\\Users\\<username>\\AppData\\Local\\Temp\\payload.exe"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high

---
- title: Monitor for Establishing Persistence
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Identify the creation of scheduled tasks using schtasks.exe that reference the malicious payload.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Windows\\System32\\schtasks.exe"
      dstNode.Type: "Process"
      command_line: "*schtasks /create /tn \"MaliciousTask\" /tr \"C:\\Users\\<username>\\AppData\\Local\\Temp\\payload.exe\"*"
  condition: selection
  tags:
    - ATT&CK ID: T1053
    - tactic: Persistence
  level: high

---
- title: Track Data Exfiltration
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor for PowerShell commands that may indicate data exfiltration using Invoke-WebRequest.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      dstNode.Type: "Network"
      outbound_connections: true
  condition: selection
  tags:
    - ATT&CK ID: T1041
    - tactic: Exfiltration
  level: high
```