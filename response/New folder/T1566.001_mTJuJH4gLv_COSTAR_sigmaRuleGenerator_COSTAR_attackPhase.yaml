```yaml
- title: Email Spoofing Detection
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Identify email delivery events where the "From" address is spoofed. Analyze email headers for discrepancies in the "From" address. Look for keywords in the subject line indicating urgency.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventType: "EmailDelivery"
      FromAddress: "spoofed@example.com"
      SubjectKeywords: ["urgent", "important"]
  condition: selection
  tags:
    - ATT&CK ID: T1566
    - tactic: Phishing
  level: high

---
- title: Malicious Attachment Type Detection
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Monitor incoming emails for attachments with specific file types (e.g., .xls, .docx). Identify and categorize these attachment types in the email logs.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventType: "EmailAttachment"
      AttachmentType: ["xls", "docx"]
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: medium

---
- title: Attachment Interaction Monitoring
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Detect when users open emails and click on attachments. Log the attachment type and monitor for common spearphishing keywords in email subjects and bodies.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventType: "EmailInteraction"
      Action: "AttachmentOpened"
      SubjectKeywords: ["spearphish", "click here"]
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: medium

---
- title: Execution of Malicious Document Detection
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Detect the execution of Microsoft Word or Excel processes initiated by opening attachments. Monitor for unusual command-line arguments associated with these processes.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      ProcessName: ["WINWORD.EXE", "EXCEL.EXE"]
      CommandLine: "*malicious*"
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Execution
  level: high

---
- title: Macro Execution Detection
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Monitor for macro execution logs when users enable macros in documents. Track document modification timestamps and log any PowerShell command execution initiated by these macros.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventType: "MacroExecution"
      MacroEnabled: true
  condition: selection
  tags:
    - ATT&CK ID: T1059
    - tactic: Execution
  level: medium

---
- title: Post-Execution Behavior Monitoring
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Investigate network connections initiated by newly executed processes, particularly those that connect to suspicious IPs. Log PowerShell command history for any commands that download additional payloads.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventType: "NetworkConnection"
      ProcessInitiated: true
      DestinationIP: "suspicious_ip"
  condition: selection
  tags:
    - ATT&CK ID: T1071
    - tactic: Command and Control
  level: high

---
- title: Persistence Mechanism Detection
  id: 123e4567-e89b-12d3-a456-426614174006
  description: Monitor for the creation of scheduled tasks or registry modifications that indicate persistence mechanisms established by malware. Log any new scheduled task entries or registry changes.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventType: "ScheduledTaskCreation"
      RegistryChange: true
  condition: selection
  tags:
    - ATT&CK ID: T1543
    - tactic: Persistence
  level: high

---
- title: File Manipulation Detection
  id: 123e4567-e89b-12d3-a456-426614174007
  description: Track file extraction events from ZIP or RAR files. Monitor for file manipulation events during extraction and log any new files created.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventType: "FileExtraction"
      FileType: ["zip", "rar"]
  condition: selection
  tags:
    - ATT&CK ID: T1203
    - tactic: Exfiltration
  level: medium

---
- title: Data Exfiltration Monitoring
  id: 123e4567-e89b-12d3-a456-426614174008
  description: Investigate network traffic logs for connections to external IPs initiated by processes executing commands to exfiltrate data. Log any suspicious network activity related to data exfiltration.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventType: "NetworkTraffic"
      Direction: "Outbound"
      SuspiciousActivity: true
  condition: selection
  tags:
    - ATT&CK ID: T1041
    - tactic: Exfiltration
  level: high

---
- title: Command-Line Execution Monitoring
  id: 123e4567-e89b-12d3-a456-426614174009
  description: Monitor command-line execution logs for suspicious executables triggered by macros. Log any new process creation that matches known malicious patterns.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      EventType: "CommandLineExecution"
      Executable: "malicious_executable"
  condition: selection
  tags:
    - ATT&CK ID: T1059
    - tactic: Execution
  level: high
```