1. **Identify Initial Access via Email**  
   - Map the event where a user receives an email with a malicious attachment.  
   - Target the `srcNode` as Microsoft Outlook (e.g., `Name: "Microsoft Outlook"`).  
   - Ensure the `dstNode` reflects the attachment file (e.g., `Name: "Invoice_2023.xlsx"`).  
   - Set the `relation` to "Process Create" to indicate the process of opening the email.  
   - Log the timestamp of the email receipt.

2. **Map User Interaction with Malicious Attachment**  
   - Identify the execution of Microsoft Excel when the user opens the attachment.  
   - Set `srcNode` to Microsoft Excel (e.g., `Name: "Microsoft Excel"`).  
   - Set `dstNode` to the malicious Excel file (e.g., `Name: "Invoice_2023.xlsx"`).  
   - Use `relation` as "Process Create" to indicate the opening of the file.  
   - Capture the timestamp of the Excel execution.

3. **Validate Macro Execution and Payload Download**  
   - Detect the execution of a PowerShell command initiated by the Excel macro.  
   - Set `srcNode` to PowerShell (e.g., `Name: "powershell.exe"`).  
   - Set `dstNode` to the URL of the malicious payload (e.g., `Dstaddress: "http://malicious-server.com/payload.exe"`).  
   - Use `relation` as "TCP Connect" to indicate the outbound connection.  
   - Log the timestamp of the PowerShell command execution.

4. **Capture Execution of the Malicious Payload**  
   - Identify the execution of the downloaded payload (e.g., `payload.exe`).  
   - Set `srcNode` to the executable (e.g., `Name: "payload.exe"`).  
   - Set `dstNode` to indicate the command and control (C2) server (e.g., `Dstaddress: "malicious-server.com"`).  
   - Use `relation` as "Process Create" for the execution of the payload.  
   - Log the timestamp of the payload execution.

5. **Document Establishing Persistence**  
   - Detect modifications to the Windows Registry for persistence.  
   - Set `srcNode` to the process making the registry changes (e.g., `Name: "reg.exe"`).  
   - Set `dstNode` to the specific registry key modified (e.g., `Key: "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"`).  
   - Use `relation` as "RegSetValue" to indicate the registry modification.  
   - Log the timestamp of the registry change.

6. **Log Task Scheduler Events**  
   - Identify the creation of a scheduled task for persistence.  
   - Set `srcNode` to the process creating the task (e.g., `Name: "schtasks.exe"`).  
   - Set `dstNode` to the task name (e.g., `Name: "malicious_task"`).  
   - Use `relation` as "Process Create" to indicate the task creation.  
   - Log the timestamp of the task creation event.