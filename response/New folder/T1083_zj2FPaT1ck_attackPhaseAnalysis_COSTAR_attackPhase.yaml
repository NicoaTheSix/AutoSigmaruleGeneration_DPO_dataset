1. **Framework Section**  
   Phase 1: *Discovery*  
   - Monitor for command-line utilities (e.g., `dir`, `ls`, `find`, `tree`) used for file and directory enumeration.  
   - Analyze logs for access to file system metadata and directory listings, particularly from known malicious tools or scripts.  
   - Identify unusual access patterns to sensitive directories or files that may indicate reconnaissance activities.  

   Phase 2: *Information Gathering*  
   - Track the use of custom scripts or tools that perform file searches or metadata retrieval, especially those targeting specific file types or directories.  
   - Monitor for API calls to the Native API or system calls that interact with file systems, such as `GetFileAttributesW`.  
   - Collect and analyze telemetry from network devices that may be used to enumerate files and directories remotely.  

   Phase 3: *Exfiltration Preparation*  
   - Detect attempts to collect or aggregate file information that may precede data exfiltration, such as file lists or metadata summaries.  
   - Monitor for commands or scripts that prepare files for encryption or exfiltration based on specific criteria (e.g., file type, modification date).  
   - Analyze network traffic for signs of data being sent to external servers, particularly after file enumeration activities.  

2. **Behavioral Patterns Section**  
   - **Pattern Name**: Command-Line Enumeration  
     - Examples: `admin@338actors used dir c:\\ >> %temp%\\downloaddir`, `cmd can be used to find files and directories with native functionality such as dir commands`  
     - Associated Phase: Phase 1  
     - Mapping to TTP ID: T1083  

   - **Pattern Name**: Custom Tool Usage  
     - Examples: `3PARA RAT has a command to retrieve metadata for files on disk`, `AcidPour can identify specific files and directories within the Linux operating system`  
     - Associated Phase: Phase 2  
     - Mapping to TTP ID: T1083  

   - **Pattern Name**: Targeted File Searches  
     - Examples: `Akira examines files prior to encryption to determine if they meet requirements for encryption`, `TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .pdf, etc.`  
     - Associated Phase: Phase 3  
     - Mapping to TTP ID: T1083  

   - **Pattern Name**: Recursive Directory Listing  
     - Examples: `Epic recursively searches for all .doc files on the system`, `CaddyWiper can enumerate all files and directories on a compromised host`  
     - Associated Phase: Phase 1  
     - Mapping to TTP ID: T1083  

   - **Pattern Name**: File Metadata Collection  
     - Examples: `Exbyte enumerates all document files on an infected machine, then creates a summary of these items`, `Gomira collects information about directory and file structures`  
     - Associated Phase: Phase 2  
     - Mapping to TTP ID: T1083  

   - **Pattern Name**: Pre-Exfiltration File Identification  
     - Examples: `Raccoon Stealer identifies target files and directories for collection based on a configuration file`, `WannaCry searches for a variety of user files by file extension before encrypting them`  
     - Associated Phase: Phase 3  
     - Mapping to TTP ID: T1083  