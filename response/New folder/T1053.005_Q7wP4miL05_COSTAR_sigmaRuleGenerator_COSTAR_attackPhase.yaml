```yaml
- title: Identify Initial Access via Email
  id: 123e4567-e89b-12d3-a456-426614174000
  description: Monitor for incoming emails where the subject line contains "Invoice Attached" and the sender's domain is suspicious.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      subject: "*Invoice Attached*"
      sender_domain: "malicious.com"
  condition: selection
  tags:
    - T1566
    - Initial Access
  level: high
---
- title: Map Opening the Malicious Attachment
  id: 123e4567-e89b-12d3-a456-426614174001
  description: Detect when a user opens an Excel file (Invoice.xlsx) that contains macros.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      process_name: "excel.exe"
      file_name: "Invoice.xlsx"
  condition: selection
  tags:
    - T1203
    - Initial Access
  level: high
---
- title: Validate Macro Execution and PowerShell Command
  id: 123e4567-e89b-12d3-a456-426614174002
  description: Monitor for PowerShell commands executed by Excel macros, specifically looking for Invoke-WebRequest commands that download a payload.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      process_name: "powershell.exe"
      command_line: "*Invoke-WebRequest*"
  condition: selection
  tags:
    - T1059
    - Execution
  level: high
---
- title: Detect Payload Execution
  id: 123e4567-e89b-12d3-a456-426614174003
  description: Track the execution of the downloaded payload (payload.exe) and ensure it is logged as a new process creation event.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      process_name: "payload.exe"
  condition: selection
  tags:
    - T1203
    - Execution
  level: high
---
- title: Monitor for Establishing Persistence
  id: 123e4567-e89b-12d3-a456-426614174004
  description: Identify the creation of a scheduled task that ensures persistence, specifically looking for commands that create tasks with names like "MaliciousTask".
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      process_name: "schtasks.exe"
      command_line: "*create*MaliciousTask*"
  condition: selection
  tags:
    - T1053
    - Persistence
  level: medium
---
- title: Track Data Exfiltration Attempts
  id: 123e4567-e89b-12d3-a456-426614174005
  description: Monitor for PowerShell commands that indicate data exfiltration, particularly those using Invoke-WebRequest to send data to a C2 server.
  status: production
  author: auto-generated
  date: 2023-10-01
  logsource:
    category: custom
    product: windows
  detection:
    selection:
      process_name: "powershell.exe"
      command_line: "*Invoke-WebRequest*"
      destination: "malicious.com"
  condition: selection
  tags:
    - T1041
    - Exfiltration
  level: high
```