1. **Framework Section**  
   Phase 1: *User Identification*  
   - Analyze system logs for user account access patterns.  
   - Monitor command execution for user enumeration commands (e.g., `whoami`, `quser`, `dscl`).  
   - Collect and review environment variables related to user sessions (e.g., `%USERNAME%`, `$USER`).  

   Phase 2: *Session Discovery*  
   - Track active user sessions and their privileges using commands like `query user` and `show users`.  
   - Investigate process ownership to identify which users are running specific processes.  
   - Examine network device logs for user login activity (e.g., `show ssh`).  

   Phase 3: *Credential Harvesting*  
   - Detect attempts to access or dump user credentials from memory or files.  
   - Monitor for the use of known credential dumping tools and techniques.  
   - Analyze outbound connections for data exfiltration related to user information.  

2. **Behavioral Patterns Section**  
   - **Pattern Name**: User Enumeration via Command Execution  
     - Examples: "APT32 collected the victim's username and executed the whoami command on the victim's machine."  
     - Associated Phase: User Identification  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: Session Information Retrieval  
     - Examples: "FIN7 has used the command cmd.exe /C quser to collect user session information."  
     - Associated Phase: Session Discovery  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: Credential Collection  
     - Examples: "Agent.btz obtains the victim username and saves it to a file."  
     - Associated Phase: Credential Harvesting  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: Environment Variable Access  
     - Examples: "Various Lazarus Group malware enumerates logged-on users."  
     - Associated Phase: User Identification  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: Privilege Verification  
     - Examples: "An APT3 downloader uses the Windows command 'cmd.exe' /C whoami to verify that it is running with the elevated privileges of 'System.'"  
     - Associated Phase: Session Discovery  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: User Information Exfiltration  
     - Examples: "Felismus collects the current username and sends it to the C2 server."  
     - Associated Phase: Credential Harvesting  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: User Account Discovery  
     - Examples: "Caterpillar WebShell can obtain a list of user accounts from a victim's machine."  
     - Associated Phase: User Identification  
     - Mapping to TTP ID: T1033  

   - **Pattern Name**: Network User Discovery  
     - Examples: "Koadic can identify logged in users across the domain and views user sessions."  
     - Associated Phase: Session Discovery  
     - Mapping to TTP ID: T1033  