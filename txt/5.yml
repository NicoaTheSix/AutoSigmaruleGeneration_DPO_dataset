title: Detect File/Extension Masquerading on Execution
id: 1bb7692b-0f3b-439e-a9be-f239b7f21955
description: Detects execution of files with double extensions or misleading file types from user-facing applications.
status: production
author: auto-generated
date: 2025-07-13
logsource:
  category: custom
  product: windows
detection:
  selection:
    relation: Process Create
    srcNode.Image|endswith:
      - explorer.exe
      - outlook.exe
      - thunderbird.exe
      - chrome.exe
      - msedge.exe
      - firefox.exe
    dstNode.Image|endswith:
      - .pdf.exe
      - .doc.exe
      - .docx.lnk
      - .xls.lnk
      - .pdf.lnk
    dstNode.Cmdline|contains:
      - \Downloads\
      - \Desktop\
      - \Temp\
  condition: selection
tags:
  - attack.t1566.001
  - attack.defense_evasion
level: high